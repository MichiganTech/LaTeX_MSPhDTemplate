%
% MichiganTech.cls
% Do not edit this file unless there is an absolute need, and/or in the
% absence of knowledge of LaTeX class.

%
% LaTeX compiler
\NeedsTeXFormat{LaTeX2e}

%
% Class name and a brief description
\ProvidesClass{MichiganTech}[2014/07/23 Thesis/Dissertation Class]

%
% Document class (and options) to load
\LoadClass[letterpaper,twoside,12pt,fleqn]{report}

%
% Packages
\RequirePackage{amsfonts}
\RequirePackage{amsmath}
\RequirePackage{amssymb}
\RequirePackage{appendix}
\RequirePackage[small,normal,bf,up]{caption}
\RequirePackage[usenames,dvipsnames]{xcolor}
\RequirePackage{enumerate}
\RequirePackage{epsfig}
\RequirePackage{fancybox}
\RequirePackage{fancyhdr}
\RequirePackage{fancyvrb}
\RequirePackage[hang,flushmargin,multiple]{footmisc}
\RequirePackage{framed}
\RequirePackage{graphicx}
\RequirePackage{lastpage}
\RequirePackage{latexsym}
\RequirePackage{listings}
\RequirePackage{longtable}
\RequirePackage{lscape}
\RequirePackage{makeidx}
\RequirePackage{multicol}
\RequirePackage{multirow}
\RequirePackage[square,comma,sort,numbers]{natbib}
\RequirePackage{nextpage}
\RequirePackage{pstricks}
\RequirePackage{pst-all}
\RequirePackage{rotate}
\RequirePackage{rotating}
\RequirePackage{setspace}
\RequirePackage{subfigure}
\RequirePackage{textcomp}
\RequirePackage{titlesec}
\RequirePackage[nottoc]{tocbibind}
\RequirePackage[subfigure]{tocloft}
\RequirePackage{upquote}
\RequirePackage{url}
\RequirePackage{wrapfig}
\RequirePackage[bookmarks,linktocpage]{hyperref}
\RequirePackage{breakurl}

%
% Process Degree=MS|PhD option in document class and load appropriate style 
% file. This, in turn, will include the appropriate title and signature pages.
\RequirePackage{kvoptions}
\DeclareStringOption[]{Degree}[]
\ProcessKeyvalOptions*
\RequirePackage{Packages/\MichiganTech@Degree}

%
% Page format
\setlength{\oddsidemargin}{0.50in}  % Left side margin for odd numbered pages
\setlength{\evensidemargin}{0.00in} % Right side margin for even numbered pages
\setlength{\topmargin}{0.00in}      % Top margin
\setlength{\headheight}{0.00in}     % Header height
\setlength{\headsep}{0.00in}        % Separation between header and main text
\setlength{\topskip}{0.00in}        % Top skip
\setlength{\textwidth}{6.00in}      % Width of the text
\setlength{\textheight}{8.50in}     % Height of the text
\setlength{\footskip}{0.50in}       % Foot skip
\setlength{\parindent}{0.00in}      % First line indentation
\setlength{\parskip}{0.25in}        % Space between two paragraphs

%
% Captions (figures, tables, etc.)
\setlength{\floatsep}{0.15in}          % Space left between floats.
\setlength{\textfloatsep}{\floatsep}   % Space between last top float
                                       % or first bottom float and the text
\setlength{\intextsep}{\floatsep}      % Space left on top and bottom
                                       % of an in-text float
\setlength{\abovecaptionskip}{0.10in}  % Space above caption
\setlength{\belowcaptionskip}{0.10in}  % Space below caption
\setlength{\captionmargin}{0.50in}     % Left/Right margin for caption
\setlength{\captionwidth}{5.00in}      % Caption width
\setlength{\abovedisplayskip}{-0.10in} % Space before Math stuff
\setlength{\belowdisplayskip}{-0.10in} % Space after Math stuff
\setlength{\arraycolsep}{0.10in}       % Gap between columns of an array
\setlength{\itemsep}{0.10in}           % Space between successive items

%
% These set up the table style to fit current guidelines
\DeclareCaptionFormat{mtutable}{#1#2\\#3}
\captionsetup[table]{format=mtutable,labelsep=none,justification=centering}

%
% Allow for consistent section/subsection spacing. This Forces LaTeX 
% to keep the same amount of space above and below each title, not 
% using them as flexible space
\titlespacing*{\section}{0cm}{0.5cm}{0.5cm}[0cm]
\titlespacing*{\subsection}{0cm}{0.5cm}{0.5cm}[0cm]
\titlespacing*{\subsubsection}{0cm}{0.5cm}{0.5cm}[0cm]

%
% Page style
\pagestyle{plain}

%
% Counters
\setcounter{tocdepth}{4}      % Depth of table of contents
\setcounter{lofdepth}{2}      % Depth of list of figures (subfigure)
\setcounter{secnumdepth}{5}   % Depth of section numbering
\setcounter{totalnumber}{50}
\setcounter{topnumber}{50}
\setcounter{bottomnumber}{50}

%
% Redefined commands and environments
\renewcommand{\thesection}{\thechapter.\arabic{section}}
\renewcommand{\thesubsection}{\thechapter.\arabic{section}.\arabic{subsection}}
\renewcommand{\thesubsubsection}{\thechapter.\arabic{section}.\arabic{subsection}.\arabic{subsubsection}}
\renewcommand{\thefigure}{\thechapter.\arabic{figure}}
\renewcommand{\thetable}{\thechapter.\arabic{table}}
\renewcommand{\theequation}{\thechapter.\arabic{equation}}
\renewcommand{\labelitemi}{$\dag$}
\renewcommand{\bibname}{References}
\renewcommand\floatpagefraction{.9}
\renewcommand\topfraction{.9}
\renewcommand\bottomfraction{.9}
\renewcommand\textfraction{.1}
\renewcommand{\cftchapleader}{\cftdotfill{\cftsecdotsep}}

%
% Prevents page numbers (roman numerals) from going beyond the right margin
\cftsetpnumwidth{3em}  

%
% Theorem environment
\newtheorem{theorem}{Theorem}

%
% Graphics type and search path
\graphicspath{{.}{./Figures/}}
\DeclareGraphicsExtensions{.eps,.ps,.jpg,.gif}

%
% Double spaced document
\newcommand{\lineheight}{2.0}
\renewcommand{\baselinestretch}{\lineheight}

%
% Single spaced footnotes
\newcommand{\munfootnote}[1]{%
  \renewcommand{\baselinestretch}{1.0}%
  \footnote{#1}%
  \renewcommand{\baselinestretch}{\lineheight}%
}

%
% Prevent pagebreaks at hyphens (this will result in underfull vbox, so an 
% alternative is to use \brokenpenalty=100 and manually search for and 
% fix such page breaks)
\brokenpenalty=10000

%
% Retrieve values for different variables from john_DEGREE.tex
\def\title#1{\gdef\@title{#1}}
\def\author#1{\gdef\@author{#1}}
\def\department#1{\gdef\@department{#1}}
\def\school#1{\gdef\@school{#1}}
\def\program#1{\gdef\@program{#1}}
\def\university#1{\gdef\@university{#1}}
\def\year#1{\gdef\@year{#1}}
\def\primaryadvisor#1{\gdef\@primaryadvisor{#1}}
\def\coadvisor#1{\gdef\@coadvisor{#1}}
\def\departmentchair#1{\gdef\@departmentchair{#1}}
\def\schooldean#1{\gdef\@schooldean{#1}}
\def\advcommone#1{\gdef\@advcommone{#1}}
\def\advcommtwo#1{\gdef\@advcommtwo{#1}}
\def\advcommthree#1{\gdef\@advcommthree{#1}}
\def\advcommfour#1{\gdef\@advcommfour{#1}}

%
% Colors
% http://www.w3schools.com/html/html_colorvalues.asp
\definecolor{Black}{HTML}{000000}
\definecolor{Navy}{HTML}{000080}
\definecolor{DarkBlue}{HTML}{00008B}
\definecolor{MediumBlue}{HTML}{0000CD}
\definecolor{Blue}{HTML}{0000FF}
\definecolor{DarkGreen}{HTML}{006400}
\definecolor{Green}{HTML}{008000}
\definecolor{Teal}{HTML}{008080}
\definecolor{DarkCyan}{HTML}{008B8B}
\definecolor{DeepSkyBlue}{HTML}{00BFFF}
\definecolor{DarkTurquoise}{HTML}{00CED1}
\definecolor{MediumSpringGreen}{HTML}{00FA9A}
\definecolor{Lime}{HTML}{00FF00}
\definecolor{SpringGreen}{HTML}{00FF7F}
\definecolor{Aqua}{HTML}{00FFFF}
\definecolor{Cyan}{HTML}{00FFFF}
\definecolor{MidnightBlue}{HTML}{191970}
\definecolor{DodgerBlue}{HTML}{1E90FF}
\definecolor{LightSeaGreen}{HTML}{20B2AA}
\definecolor{ForestGreen}{HTML}{228B22}
\definecolor{SeaGreen}{HTML}{2E8B57}
\definecolor{DarkSlateGray}{HTML}{2F4F4F}
\definecolor{LimeGreen}{HTML}{32CD32}
\definecolor{MediumSeaGreen}{HTML}{3CB371}
\definecolor{Turquoise}{HTML}{40E0D0}
\definecolor{RoyalBlue}{HTML}{4169E1}
\definecolor{SteelBlue}{HTML}{4682B4}
\definecolor{DarkSlateBlue}{HTML}{483D8B}
\definecolor{MediumTurquoise}{HTML}{48D1CC}
\definecolor{Indigo}{HTML}{4B0082}
\definecolor{DarkOliveGreen}{HTML}{556B2F}
\definecolor{CadetBlue}{HTML}{5F9EA0}
\definecolor{CornflowerBlue}{HTML}{6495ED}
\definecolor{MediumAquaMarine}{HTML}{66CDAA}
\definecolor{DimGray}{HTML}{696969}
\definecolor{SlateBlue}{HTML}{6A5ACD}
\definecolor{OliveDrab}{HTML}{6B8E23}
\definecolor{SlateGray}{HTML}{708090}
\definecolor{LightSlateGray}{HTML}{778899}
\definecolor{MediumSlateBlue}{HTML}{7B68EE}
\definecolor{LawnGreen}{HTML}{7CFC00}
\definecolor{Chartreuse}{HTML}{7FFF00}
\definecolor{Aquamarine}{HTML}{7FFFD4}
\definecolor{Maroon}{HTML}{800000}
\definecolor{Purple}{HTML}{800080}
\definecolor{Olive}{HTML}{808000}
\definecolor{Gray}{HTML}{808080}
\definecolor{SkyBlue}{HTML}{87CEEB}
\definecolor{LightSkyBlue}{HTML}{87CEFA}
\definecolor{BlueViolet}{HTML}{8A2BE2}
\definecolor{DarkRed}{HTML}{8B0000}
\definecolor{DarkMagenta}{HTML}{8B008B}
\definecolor{SaddleBrown}{HTML}{8B4513}
\definecolor{DarkSeaGreen}{HTML}{8FBC8F}
\definecolor{LightGreen}{HTML}{90EE90}
\definecolor{MediumPurple}{HTML}{9370DB}
\definecolor{DarkViolet}{HTML}{9400D3}
\definecolor{PaleGreen}{HTML}{98FB98}
\definecolor{DarkOrchid}{HTML}{9932CC}
\definecolor{YellowGreen}{HTML}{9ACD32}
\definecolor{Sienna}{HTML}{A0522D}
\definecolor{Brown}{HTML}{A52A2A}
\definecolor{DarkGray}{HTML}{A9A9A9}
\definecolor{LightBlue}{HTML}{ADD8E6}
\definecolor{GreenYellow}{HTML}{ADFF2F}
\definecolor{PaleTurquoise}{HTML}{AFEEEE}
\definecolor{LightSteelBlue}{HTML}{B0C4DE}
\definecolor{PowderBlue}{HTML}{B0E0E6}
\definecolor{FireBrick}{HTML}{B22222}
\definecolor{DarkGoldenRod}{HTML}{B8860B}
\definecolor{MediumOrchid}{HTML}{BA55D3}
\definecolor{RosyBrown}{HTML}{BC8F8F}
\definecolor{DarkKhaki}{HTML}{BDB76B}
\definecolor{Silver}{HTML}{C0C0C0}
\definecolor{MediumVioletRed}{HTML}{C71585}
\definecolor{IndianRed}{HTML}{CD5C5C}
\definecolor{Peru}{HTML}{CD853F}
\definecolor{Chocolate}{HTML}{D2691E}
\definecolor{Tan}{HTML}{D2B48C}
\definecolor{LightGray}{HTML}{D3D3D3}
\definecolor{Thistle}{HTML}{D8BFD8}
\definecolor{Orchid}{HTML}{DA70D6}
\definecolor{GoldenRod}{HTML}{DAA520}
\definecolor{PaleVioletRed}{HTML}{DB7093}
\definecolor{Crimson}{HTML}{DC143C}
\definecolor{Gainsboro}{HTML}{DCDCDC}
\definecolor{Plum}{HTML}{DDA0DD}
\definecolor{BurlyWood}{HTML}{DEB887}
\definecolor{LightCyan}{HTML}{E0FFFF}
\definecolor{Lavender}{HTML}{E6E6FA}
\definecolor{DarkSalmon}{HTML}{E9967A}
\definecolor{Violet}{HTML}{EE82EE}
\definecolor{PaleGoldenRod}{HTML}{EEE8AA}
\definecolor{LightCoral}{HTML}{F08080}
\definecolor{Khaki}{HTML}{F0E68C}
\definecolor{AliceBlue}{HTML}{F0F8FF}
\definecolor{HoneyDew}{HTML}{F0FFF0}
\definecolor{Azure}{HTML}{F0FFFF}
\definecolor{SandyBrown}{HTML}{F4A460}
\definecolor{Wheat}{HTML}{F5DEB3}
\definecolor{Beige}{HTML}{F5F5DC}
\definecolor{WhiteSmoke}{HTML}{F5F5F5}
\definecolor{MintCream}{HTML}{F5FFFA}
\definecolor{GhostWhite}{HTML}{F8F8FF}
\definecolor{Salmon}{HTML}{FA8072}
\definecolor{AntiqueWhite}{HTML}{FAEBD7}
\definecolor{Linen}{HTML}{FAF0E6}
\definecolor{LightGoldenRodYellow}{HTML}{FAFAD2}
\definecolor{OldLace}{HTML}{FDF5E6}
\definecolor{Red}{HTML}{FF0000}
\definecolor{Fuchsia}{HTML}{FF00FF}
\definecolor{Magenta}{HTML}{FF00FF}
\definecolor{DeepPink}{HTML}{FF1493}
\definecolor{OrangeRed}{HTML}{FF4500}
\definecolor{Tomato}{HTML}{FF6347}
\definecolor{HotPink}{HTML}{FF69B4}
\definecolor{Coral}{HTML}{FF7F50}
\definecolor{DarkOrange}{HTML}{FF8C00}
\definecolor{LightSalmon}{HTML}{FFA07A}
\definecolor{Orange}{HTML}{FFA500}
\definecolor{LightPink}{HTML}{FFB6C1}
\definecolor{Pink}{HTML}{FFC0CB}
\definecolor{Gold}{HTML}{FFD700}
\definecolor{PeachPuff}{HTML}{FFDAB9}
\definecolor{NavajoWhite}{HTML}{FFDEAD}
\definecolor{Moccasin}{HTML}{FFE4B5}
\definecolor{Bisque}{HTML}{FFE4C4}
\definecolor{MistyRose}{HTML}{FFE4E1}
\definecolor{BlanchedAlmond}{HTML}{FFEBCD}
\definecolor{PapayaWhip}{HTML}{FFEFD5}
\definecolor{LavenderBlush}{HTML}{FFF0F5}
\definecolor{SeaShell}{HTML}{FFF5EE}
\definecolor{Cornsilk}{HTML}{FFF8DC}
\definecolor{LemonChiffon}{HTML}{FFFACD}
\definecolor{FloralWhite}{HTML}{FFFAF0}
\definecolor{Snow}{HTML}{FFFAFA}
\definecolor{Yellow}{HTML}{FFFF00}
\definecolor{LightYellow}{HTML}{FFFFE0}
\definecolor{Ivory}{HTML}{FFFFF0}
\definecolor{White}{HTML}{FFFFFF}

%
% Options for listings (source code inclusion)
\lstset{
  backgroundcolor=\color{white},
  tabsize=2,
  rulecolor=,
  upquote=true,
  aboveskip={1.0\baselineskip},
  columns=fixed,
  extendedchars=true,
  breaklines=true,
  prebreak = \raisebox{0ex}[0ex][0ex]{\ensuremath{\hookleftarrow}},
  frame=none,
  basicstyle=\ttfamily,
  identifierstyle=\color{DarkOliveGreen}\ttfamily,
  keywordstyle=\color{Magenta}\ttfamily,
  commentstyle=\color{Blue}\ttfamily,
  stringstyle=\color{SaddleBrown}\ttfamily,
  showtabs=false,
  showspaces=false,
  showstringspaces=false
}

%
% Abstract
\renewcommand{\abstract}{
  \cleartooddpage[\thispagestyle{empty}]
  \thispagestyle{plain}
  \phantomsection
  \section*{Abstract}
  \addcontentsline{toc}{chapter}{Abstract}
  \input{FrontMatter/Abstract}
  \cleartooddpage[\thispagestyle{empty}]
  \newpage
  \pagenumbering{arabic}
}

%
% Acknowledgments
\newcommand{\acknowledgments}{
  \cleartooddpage[\thispagestyle{empty}]
  \thispagestyle{plain}
  \phantomsection
  \section*{Acknowledgments}
  \addcontentsline{toc}{chapter}{Acknowledgments}
  \input{FrontMatter/Acknowledgments}
  \newpage
}

%
% Dedication
\newcommand{\dedication}{
  \cleartooddpage[\thispagestyle{empty}]
  \thispagestyle{empty}
  \phantomsection
  \section*{Dedication}
  \input{FrontMatter/Dedication}
  \newpage
}

%
% Preface
\newcommand{\preface}{
  \cleartooddpage[\thispagestyle{empty}]
  \thispagestyle{plain}
  \phantomsection
  \section*{Preface}
  \addcontentsline{toc}{chapter}{Preface}
  \input{FrontMatter/Preface}
  \newpage
}

%
% Table of Contents, List of Figures and List of Tables
\newcommand{\contentsfigurestables}{
  \cleartooddpage[\thispagestyle{empty}]
  \thispagestyle{plain}

  % Table of Contents
  \currentpdfbookmark{Contents}{Contents}
  \tableofcontents

  % List of Figures
  \cleartooddpage[\thispagestyle{empty}]
  \thispagestyle{plain}
  \listoffigures

  % List of Tables
  \cleartooddpage[\thispagestyle{empty}]
  \thispagestyle{plain}
  \listoftables
  \newpage
}
